# Tekton Helm Chart for ArgoCD applications

It accepts two parameters:

* [tekton_host](values.yaml#L2) - hostname for tekton-dashboard
* [ingressCertificate](values.yaml#L5) - secret containing the wildcard
  certificate generated by cert-manager

For example:

```shell
helm template --set tekton_host=tekton-dashboard.myexample.com --set ingress-certificate=ingressCertificate .
```

## Notes

These files which are part of the helm chart are taken from upstream:

* [templates/tekton-pipelines.yaml](templates/tekton-pipelines.yaml) - upstream:
  [Tekton Pipeline v0.10.0 - release.yaml](https://github.com/tektoncd/pipeline/releases/download/v0.10.0/release.yaml)
* [templates/tekton-dashboard.yaml](templates/tekton-dashboard.yaml) - upstream:
  [Tekton Dashboard v0.4.1 - dashboard_latest_release.yaml](https://github.com/tektoncd/dashboard/releases/download/v0.4.1/dashboard_latest_release.yaml)

**Note** - there is one change introduced to the original [tekton-pipelines.yaml](https://github.com/tektoncd/pipeline/releases/download/v0.10.0/release.yaml)
file:

```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: tekton-pipelines
  labels:
    app: kubed
```

The label `app: kubed` was added there to allow [kubed](https://github.com/appscode/kubed)
to copy the certificate [ingressCertificate](values.yaml#L5) generated by [cert-manager](https://github.com/jetstack/cert-manager).

Everything else is "default" and should not be changed to let updating this
helm chart easily.

## Other notes

The reason why Tekton and Prow are merged together is that tekton pipelines
needs to be located in `prowjob` namespace created by tekton.

There is no way how to create dependencies betwen ArgoCD applications so when
these two were separated it happened, that Prow tried to create Tekton pipelines
before Tekton's CRDs were in place.
